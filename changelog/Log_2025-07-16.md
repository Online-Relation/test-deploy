## Changelog - GPT session 2025-07-16 ##
1. Databasens tabeller (Supabase)
A. modal_objects
Hovedtabel for alle modal-forekomster.
Kolonner (alle relevante):

Kolonnenavn	Type	Noter
id	uuid	Primærnøgle (autogen.)
type	text	F.eks. 'fantasy', 'bucketlist'
reference_id	text/uuid	ID fra relateret tabel (valgfri)
title	text	Titel for modal (valgfri)
image_url	text	Banner-billede (valgfri)
created_by	uuid	User id (relationsnøgle)
created_at	timestamp	
categories	jsonb	Array af kategori-objekter
gallery_images	jsonb	Array af billeder
description	text	Richtext/HTML

B. modal_categories
Kategorier, der kan vælges og tilføjes på modaler.

Kolonnenavn	Type	Noter
id	uuid	Primærnøgle
label	text	Navn på kategori
color	text	'orange'
type	text	F.eks. 'fantasy', 'bucketlist'
...	...	

C. comments
Kommentarer til modal (pr. modal id).

Kolonnenavn	Type	Noter
id	uuid	
modal_id	uuid	Reference til modal_objects
text	text	Kommentar-indhold
author	uuid	User id
author_name	text	Vises i UI
created_at	timestamp	

2. Kernefiler & komponenter i frontend
(Sti & formål – seneste/aktive versioner)

/lib/modalObjects.ts
CRUD-funktioner: createModalObject, updateModalObject, fetchModalObject, fetchAllModalObjects. Håndterer hele modal-objektet, inkl. kategorier, billeder, beskrivelse m.m. via jsonb-felter.

/components/ui/globalmodal/ModalCard.tsx
Viser kort (card) for hver modal på fx en oversigtsside. Åbner modal-popup via GlobalModal og viser bruger, titel, billede, kategori, kommentar osv. Benytter updateModalObject til redigering.

/components/ui/globalmodal/GlobalModal.tsx
Den egentlige modal-popup-komponent. Viser indhold, galleri, richtext, badge, og lader brugeren redigere modal-objekt via GlobalModalEditForm.

/components/ui/globalmodal/GlobalModalEditForm.tsx
Formular til at redigere titel, billede, galleri, kategori, beskrivelse osv. Kalder onSave med alle data.

/components/ui/globalmodal/CategorySelect.tsx
Søg, vælg eller opret kategori (med type-felt). Henter/sender data til modal_categories.

/components/ui/globalmodal/CommentSection.tsx
Viser kommentarer for den aktuelle modal (modal_id). Håndterer post/fetch via Supabase.

/components/ui/globalmodal/types.ts
Indeholder type-definitioner for bl.a. Category og GalleryImage.

3. Modal-objektets dataflow og logik
Et modal-objekt har:

title (text)

type (text, bruges til at filtrere, gruppere osv.)

categories (array af category-objekter, jsonb)

gallery_images (array, jsonb)

image_url (enkelt bannerbillede)

beskrivelse (richtext/HTML)

relationer til bruger (created_by) og kommentarer

Når du opretter eller redigerer modal:

Data gemmes som JSON (categories, gallery_images).

Type skal vælges eller oprettes, præcis som kategori (det mangler stadig at blive lavet som UI, se nedenfor).

CRUD-funktioner i /lib/modalObjects.ts sørger for oprettelse, læsning og opdatering i Supabase.

4. Hvad mangler/følgende steps?
A. Type-vælger og type-håndtering
Du mangler et felt til at vælge eller oprette 'type' direkte fra modal-edit-form.

Det skal virke nøjagtig ligesom CategorySelect – altså at man kan vælge mellem eksisterende 'types', søge, og oprette ny type. Type skal sendes til både modal-objektet og til evt. nye kategorier, så kategorier altid oprettes med type.

B. UI til at vise og vælge type
Tilføj en ny komponent f.eks. TypeSelect, eller udvid din form i GlobalModalEditForm.tsx med et nyt felt.

Feltet skal være required.

C. Korrekt opdatering og visning
Sikre at når type, kategori, billede, galleri eller beskrivelse opdateres, så gemmes de korrekt i Supabase, og de kommer med retur (jsonb til array).

D. Validering og feedback
Hvis du forsøger at oprette kategori uden type, skal det fejle pænt.

Hvis du mangler required fields i modal (fx type), skal formularen vise en fejl.

E. Overblik/testside
En testside hvor du kan oprette, redigere og gennemgå alle modaler, og hvor du kan åbne en modal direkte via id (evt. via link).

5. Eksempel på MODAL-OBJECT JSON
json
Kopiér
Rediger
{
  "id": "12345-uuid",
  "type": "fantasy",
  "title": "Min første fantasi",
  "image_url": "https://...",
  "gallery_images": [
    { "id": "a", "url": "https://...", "alt": "..." }
  ],
  "categories": [
    { "id": "b", "label": "Intimitet", "color": "orange" }
  ],
  "description": "<p>Richtext her...</p>",
  "created_by": "user-uuid",
  "created_at": "2025-07-16T..."
}
6. TODO / NÆSTE SKRIDT
Tilføj type-select/TypeSelect-komponent i modal-form, præcis som med kategorier.

Brug et separat table modal_types eller fetch unikke fra eksisterende data.

Sørg for at type sendes og gemmes sammen med modal og kategori.

UI-validering: type skal være required.

Test redigering og oprettelse af modal med alle felter (title, image, description, type, categories, galleri).

(Valgfrit) Link direkte til modal fra andre widgets via id.

Kort opsummering:
modal_objects er hovedtabellen.

categories og gallery_images gemmes som JSON arrays (jsonb).

type-feltet bruges til at skelne mellem fx 'fantasy', 'bucketlist' osv.

Du mangler: UI til type-vælger + validering i forms + at sikre type altid sendes ved kategori-oprettelse.

Kommentarer og brugere håndteres med egne tabeller og relationer.



## Changelog - GPT session 2025-07-14 Part 3 ##

Modal Feature Changelog
Overblik
Denne changelog dokumenterer udviklingen og implementeringen af modalfunktioner. Den opdateres løbende efterhånden som nye funktioner tilføjes eller eksisterende forbedres.

Planlagte funktioner
Galleri-upload og visning

Mulighed for at uploade flere billeder i et galleri

Galleri vises som små billeder i toppen af modal med pile til scrolling

Kommentarer

Brugere kan skrive kommentarer med tilknytning af dato og brugernavn

Navigation mellem modaler

Pile eller swipe-funktion til at skifte mellem forskellige modaler

Modalbaggrund med sløring

Baggrunden sløres med backdrop-blur-sm og let hvid overlay (bg-white/80)

Knapper

Alle knapper skal bruge fælles btn-klasse fra globals.css

Dato for oprettelse

Visning af dato for, hvornår mindet eller billedet blev oprettet

Fuld størrelse billede

Billedet i modal vises i fuld størrelse (uden hvidt margin eller beskæring)

Upload-knap som CTA

Upload-knap til billeder skal være visuelt fremtrædende (Call to Action)

RichText Editor

Mulighed for at redigere tekst i modal med RichText editor

Like-funktion

Mulighed for at "❤️" et minde direkte i modal (lille ikon med antal likes)

Download-knap

Mulighed for at downloade billedet fra modal

Vis brugerinfo under billede

Viser upload-dato, lille avatar og brugernavn for den, der uploadede billedet

Glidende animation ved billedskift

En let animation ved skift mellem billeder i galleriet for bedre brugeroplevelse

Rediger-knap med fuld redigering

En rediger-knap der åbner et interface til at redigere alle modalens data (billeder, titel, tekst, kategorier etc.)

Status pr. nuværende tidspunkt
Pkt. 1 (Galleri-upload og visning):

Galleri vises korrekt med thumbnails og scroll.

Uploadfunktionalitet er under udvikling, men ikke helt færdig.

Pkt. 14 (Rediger-knap med fuld redigering):

Grundlæggende redigeringsknap fungerer og åbner et separat redigeringsform.

Integration og synkronisering med galleri og modalens øvrige data skal finpudses.

Andre punkter:

Ikke påbegyndt endnu.

Næste skridt
Færdiggøre galleri-upload (pkt. 1) inkl. upload-CTA knap og animation (pkt. 8 og 13)

Forbedre redigeringsinterface og dataflow for fuld redigering (pkt. 14)

Påbegynde kommentar- og like-funktioner (pkt. 2 og 10)

Bemærkninger
Arbejdet foregår løbende i komponenterne GlobalModal.tsx, ImageGallery.tsx og GlobalModalEditForm.tsx

Changelog vil blive opdateret efter hvert større trin

⚠️ Husk at bruge denne changelog som reference for udvikling, så vi undgår dobbeltarbejde og sikrer overblik i modalprojektet. ⚠️